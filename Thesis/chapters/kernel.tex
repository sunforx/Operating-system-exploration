\chapter{编写操作系统内核}

从内存管理，输入输出，多进程，分时四个模块丰富操作系统的内容

\section{内存管理}

内存 (RAM) 是计算机中不可缺少的重要硬件，所有程序的运行都是在内存中进行的，
而CPU访问硬盘数据也必须先经过内存交换才得以实现，内存在加速CPU访问硬盘居功至伟。
由内存的重要性可知内存管理在操作系统中也非常重要。	

内存的结构通常用地址和空间表示，在计算机运行过程中，
内存的分配是随机的，导致内存的释放也是相对无序的，这样导致了很多的碎片化问题，
也就是随计算机运行时间变长，内存中到处遍布小块零散空闲空间，虽然零散空间总数很大，
但很难满足新进程序的内存需求，于是内存管理显得十分必要。

内存管理设计的主要目的是快速并且高效的分配内存空间，并在适当的时间释放并回收内存空间。
根据内存管理的设计目的，内存管理的数据结构如下:

\begin{listing}[H]
  \inputminted[tabsize=2, firstline=137, lastline=143,
  linenos=true]{c}{../ZOS/src/kernel/bootpack.h}
\end{listing}

\begin{description}
\item[frees:]空闲空间数量
\item[maxfrees:]用于观察可用状况：frees的最大值
\item[lostsize:]释放失败的内存的大小总和
\item[losts:]释放失败次数
\end{description}

经过内存初始化和释放所有内存空间后，内存管理正常运行。

% memory
\include{chapters/sections/memory}

% multi
\include{chapters/sections/io}

% multi
\include{chapters/sections/multi}

% ctss
\include{chapters/sections/ctss}